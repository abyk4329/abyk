# מחברת תקלות ופתרונות

> בכל פעם שאנחנו נתקלים בתקלה שחוזרת על עצמה, נכתוב פה את הפרטים, הסיבה, הפתרון והפרומפט המומלץ לקופילוט.

## 2025-10-18 · פריסת חלון הקוקיז מתפרקת במסכים רחבים

- **התופעה**: הגדלת המסך גרמה לכפתור "הבנתי" לצאת מגבולות הכרטיס והטקסט נדבק לצד ימין.
- **הסיבה**: במצב רוחבי (‎`flex-direction: row`‎) הפריסה נשענה על `flex: 1` ו־`white-space: nowrap` ללא הגבלות רוחב ויישור מרכזי, כך שב־RTL האלמנטים נדחקו לשוליים.
- **הפתרון**: הוספת `flex-wrap` ויישור מרכזי לכל האלמנטים, הגבלת רוחב הטקסט ל־`min(420px, 100%)` והגדרת הכפתור ליישור עצמי במרכז. השינויים בוצעו בקובץ `app/components/layout/CookieConsent.module.css`.
- **פרומפט מומלץ להמשך**:
  > "הפריסה של חלון הקוקיז במסכים רחבים נשברת – תוודא שהטקסט והכפתור נשארים ממורכזים, ותוסיף הסברים למה זה קרה כדי שנמנע מזה בהמשך."

## 2025-10-18 · כרטיס ההירו נדבק לראש העמוד במסכים גבוהים

- **התופעה**: במסכים גדולים במיוחד (מעל ~1200px גובה) כרטיס ההירו בעמוד הבית התרומם יתר על המידה ונצמד לשול העליון, מה שפגע במרכב האיזון הוויזואלי.
- **הסיבה**: ערכי ההזחה הוגדרו ב־CSS כ־`vh-` קבועים (`-12vh`, `-15vh` וכו') ללא תקרה, ולכן ככל שהמסך היה גבוה יותר הכרטיס נמשך למעלה.
- **הפתרון**: החלפת ההזחות ל־`clamp` המבוסס על טוקני הריווח (‎`--space-*`‎) כך שהכרטיס נשאר מורם בעדינות אך מוגבל בטווח סביר. השינוי יושם ב־`app/globals.css` (העדכון של `--hero-offset-group-*`).
- **פרומפט מומלץ להמשך**:
  > "במסכים גבוהים כרטיס ההירו נדבק לראש המסך – תוודא שההזזה האנכית מבוססת clamp עם טוקני הריווח כדי למנוע הגזמה ותסביר למה זה עדיף."

## 2025-10-18 · צבעים וצללות שאינם תואמים בין העמודים

- **התופעה**: חלק מהכרטיסיות/אייקונים קיבלו צבעים או `box-shadow` שונים, כך שהעיצוב הנאומורפי לא היה אחיד בין עמודים שונים.
- **הסיבה**: קבצי CSS ישנים נשענו על ערכי `rgba` ו־`box-shadow` ידניים במקום על טוקני העיצוב המרוכזים ב־`app/globals.css`, ולכן כל עדכון בוצע בנפרד ולא נשמר מקור אמת אחיד.
- **הפתרון**: לאחד את כל הצללות והצבעים ל־Design Tokens הגלובליים:
  - צבעים/טיפוגרפיה → הטוקנים תחת `:root` ב־`app/globals.css` (לדוגמה `--neu-text-primary`, `--neu-accent`).
  - צללות נאומורפיות → הטוקנים `--shadow-*` המוגדרים באותו קובץ ובהרחבות שב־`app/styles/neu.module.css` ו־`app/components/shared/neumorphic.module.css`.
  - אם חסר טוקן: מוסיפים alias חדש ב־`app/globals.css` במקום להכניס ערך קשיח.
- **פרומפט מומלץ להמשך**:
  > "תסרוק את כל קבצי ה-CSS ותאתר צבעים או box-shadow עם ערכי rgba/px ידניים. תחליף אותם בטוקנים שמוגדרים ב-`app/globals.css` (צבעים `--neu-*`, צללות `--shadow-*`). אם חסר טוקן תוסיף alias חדש שם, תוך הסבר קצר בקובץ. עצר רק לאחר שכל הרכיבים מתבססים על מקור אמת יחיד."

## 2025-10-19 · שכבת הרקע/הדר משתנה בין עמודים (Surface Drift)

- **התופעה**: במסכי הפאנל (מחשבון, תוצאה, תודה וכו׳) הרקע של העמוד, ההדר והתפריט הצדדי הופיעו בצבע אטום ששבר את המראה השקוף של עמוד הבית. לעיתים גם הכרטיס המרכזי נחתך בגלל padding/overflow שנוספו.
- **הסיבה**: שני גורמים מרכזיים:
  1. שינויי פדינג/transform נקודתיים בקומפוננטות (`PageShell`, `StandardPageLayout`) שהגדירו `overflow`/`padding-block` שונים מברירת המחדל של `.hero-shell`, ולכן הכרטיס התרחק והסייד-סרפס התמלא בצבע.
  2. הגדרות צבע מסלוליות (`.app-shell[data-route="..."] { --page-surface: ... }`) שנוספו עבור דפי הפאנל בשלב קודם, מה שדרס את השקיפות שירשנו מעמוד הבית.
- **הפתרון**:
  - להחזיר את השימוש ב־`.hero-shell` כעטיפת על אחידה ולהסיר padding/overflow עודפים בקומפוננטות הפנימיות. בוצעו התאמות ב־`app/components/layout/PageShell.module.css` כך שכרטיס יחיד מצטמד למרכז ללא גלילה אך עדיין נשען על רקע שקוף, וכן הוחזרו ערכי padding מתונים ונוסף `overflow: hidden` נגד גלילה מיותרת.
  - בקבצי הסגנון הגלובליים (`app/globals.css`) נבדק שלא קיימים overrides לצבעי רקע (`--page-surface`, `--page-surface-gradient`, `--header-surface`) עבור מסלולים ספציפיים. אם יש צורך ברקע ייחודי, מגדירים זאת דרך טוקנים גלובליים ולא בהגדרת route.
  - לוודא שכל עמוד משתמש באותן מחלקות בסיס (`hero-shell`, `PageShell`, `StandardPageLayout`) ללא שינויי חוקים נקודתיים.
- **פרומפט מומלץ להמשך**:
  > "תבדוק בכל קובצי ה-CSS אם יש הגדרות צבע/gradient שונות לפי `data-route` או קומפוננטות פנימיות. ודא שכל המסכים משתמשים ב-`hero-shell` ובטוקנים `--header-surface`, `--page-surface` בלבד. אם יש שוני (כמו padding חריג או overflow), החזר לברירת המחדל והסבר למה זה שבר את השקיפות."
